[0;34m[INFO][0m Starting Local CI/CD Pipeline
[0;34m[INFO][0m Project: microservice-project
[0;34m[INFO][0m Git Commit: 875f88c
[0;34m[INFO][0m Branch: main
[0;34m[INFO][0m Timestamp: Sun Aug  3 14:06:47 +07 2025
[0;34m[INFO][0m Log file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/.local-cicd-logs/pipeline_20250803_140647.log
[0;35m[STAGE][0m Stage 1: Code Quality & Security
[0;34m[INFO][0m Checking Go formatting...
[1;33m[WARNING][0m Go formatting issues found. Running gofmt...
[0;34m[INFO][0m Running: Go formatting fix
Command: gofmt -w .
[0;32m[SUCCESS][0m Go formatting fix completed
[0;34m[INFO][0m Running: Go vet analysis
Command: go vet ./...
# github.com/elotusteam/microservice-project/services/auth/infrastructure
vet: services/auth/infrastructure/repositories.go:62:9: cannot use &MockLoginAttemptRepository{â€¦} (value of type *MockLoginAttemptRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository value in return statement: *MockLoginAttemptRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository (missing method GetAttemptsByTimeRange)
[0;31m[ERROR][0m Go vet analysis failed
[0;34m[INFO][0m Running: Linting with golangci-lint
Command: golangci-lint run
services/auth/infrastructure/repositories.go:1: : # github.com/elotusteam/microservice-project/services/auth/infrastructure
services/auth/infrastructure/repositories.go:62:9: cannot use &MockLoginAttemptRepository{â€¦} (value of type *MockLoginAttemptRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository value in return statement: *MockLoginAttemptRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository (missing method GetAttemptsByTimeRange)
services/auth/infrastructure/repositories.go:67:9: cannot use &MockPasswordResetRepository{â€¦} (value of type *MockPasswordResetRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository value in return statement: *MockPasswordResetRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository (missing method IsValidToken)
services/auth/infrastructure/repositories.go:72:9: cannot use &MockActivityLogRepository{â€¦} (value of type *MockActivityLogRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository value in return statement: *MockActivityLogRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository (wrong type for method GetUserActivity)
		have GetUserActivity(context.Context, string, *data.Pagination) (*data.PaginatedResult, error)
		want GetUserActivity(context.Context, string, time.Time) (map[string]int64, error)
services/auth/infrastructure/repositories.go:1042:20: invalid operation: log.UserID == userID (mismatched types *string and string) (typecheck)
package infrastructure
[0;31m[ERROR][0m Linting with golangci-lint failed
[0;34m[INFO][0m Running: Security scanning with gosec
Command: gosec ./...
[gosec] 2025/08/03 14:07:03 Including rules: default
[gosec] 2025/08/03 14:07:03 Excluding rules: default
[gosec] 2025/08/03 14:07:03 Including analyzers: default
[gosec] 2025/08/03 14:07:03 Excluding analyzers: default
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/config
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/utils
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/config
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/security
[gosec] 2025/08/03 14:07:03 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/integration
[gosec] 2025/08/03 14:07:03 Checking package: config
[gosec] 2025/08/03 14:07:03 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/config/config.go
[gosec] 2025/08/03 14:07:04 Checking package: main
[gosec] 2025/08/03 14:07:04 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/main.go
[gosec] 2025/08/03 14:07:04 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/performance
[gosec] 2025/08/03 14:07:04 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/user
[gosec] 2025/08/03 14:07:04 Checking package: config
[gosec] 2025/08/03 14:07:04 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/config/config.go
[gosec] 2025/08/03 14:07:05 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth
[gosec] 2025/08/03 14:07:05 Checking package: utils
[gosec] 2025/08/03 14:07:05 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/utils/utils.go
[gosec] 2025/08/03 14:07:07 Checking package: usecases
[gosec] 2025/08/03 14:07:07 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/interfaces.go
[gosec] 2025/08/03 14:07:07 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/routes
[gosec] 2025/08/03 14:07:07 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go
[gosec] 2025/08/03 14:07:08 Checking package: main
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/main.go
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases
[gosec] 2025/08/03 14:07:08 Checking package: middleware
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/cors.go
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/chaos
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/rate_limit.go
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/request_id.go
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/security.go
[gosec] 2025/08/03 14:07:08 Checking package: main
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/main.go
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification
[gosec] 2025/08/03 14:07:08 Checking package: routes
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/routes/routes.go
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/file
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/auth
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain
[gosec] 2025/08/03 14:07:08 Checking package: usecases
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases/interfaces.go
[gosec] 2025/08/03 14:07:08 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases
[gosec] 2025/08/03 14:07:08 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases/user_service.go
[gosec] 2025/08/03 14:07:10 Checking package: main
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/main.go
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/communication
[gosec] 2025/08/03 14:07:10 Checking package: main
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/main.go
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/domain
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/data
[gosec] 2025/08/03 14:07:10 Checking package: domain
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain/entities.go
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/e2e
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain/repositories.go
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain
[gosec] 2025/08/03 14:07:10 Checking package: domain
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain/entities.go
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain/repositories.go
[gosec] 2025/08/03 14:07:10 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure
[gosec] 2025/08/03 14:07:10 Checking package: data
[gosec] 2025/08/03 14:07:10 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/data/interfaces.go
[gosec] 2025/08/03 14:07:11 Checking package: domain
[gosec] 2025/08/03 14:07:11 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/entities.go
[gosec] 2025/08/03 14:07:11 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/infrastructure
[gosec] 2025/08/03 14:07:11 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/repositories.go
[gosec] 2025/08/03 14:07:11 Checking package: usecases
[gosec] 2025/08/03 14:07:11 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go
[gosec] 2025/08/03 14:07:11 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain
[gosec] 2025/08/03 14:07:13 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/interfaces.go
[gosec] 2025/08/03 14:07:13 Checking package: communication
[gosec] 2025/08/03 14:07:13 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/communication/interfaces.go
[gosec] 2025/08/03 14:07:13 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases
[gosec] 2025/08/03 14:07:13 Checking package: domain
[gosec] 2025/08/03 14:07:13 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/domain/models.go
[gosec] 2025/08/03 14:07:13 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain
[gosec] 2025/08/03 14:07:13 Checking package: main
[gosec] 2025/08/03 14:07:13 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/main.go
[gosec] 2025/08/03 14:07:13 Checking package: usecases
[gosec] 2025/08/03 14:07:13 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go
[gosec] 2025/08/03 14:07:15 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/interfaces.go
[gosec] 2025/08/03 14:07:15 Checking package: infrastructure
[gosec] 2025/08/03 14:07:15 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go
[gosec] 2025/08/03 14:07:19 Panic when running SSA analyser on package: infrastructure
[gosec] 2025/08/03 14:07:19 Error building the SSA representation of the package "infrastructure": %!s(<nil>)
[gosec] 2025/08/03 14:07:19 Checking package: infrastructure
[gosec] 2025/08/03 14:07:19 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/infrastructure/repositories.go
[gosec] 2025/08/03 14:07:21 Checking package: domain
[gosec] 2025/08/03 14:07:21 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain/entities.go
[gosec] 2025/08/03 14:07:21 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain/repositories.go
[gosec] 2025/08/03 14:07:21 Checking package: domain
[gosec] 2025/08/03 14:07:21 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain/entities.go
[gosec] 2025/08/03 14:07:21 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain/repositories.go
[gosec] 2025/08/03 14:07:21 Checking package: usecases
[gosec] 2025/08/03 14:07:21 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go
[gosec] 2025/08/03 14:07:22 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/interfaces.go
[gosec] 2025/08/03 14:07:22 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/password_service.go
[gosec] 2025/08/03 14:07:23 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/token_service.go
Results:

Golang errors in file: []:

  > [line 0 : column 0] - # command-line-arguments
services/auth/infrastructure/repositories.go:62:9: cannot use &MockLoginAttemptRepository{â€¦} (value of type *MockLoginAttemptRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository value in return statement: *MockLoginAttemptRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository (missing method GetAttemptsByTimeRange)
services/auth/infrastructure/repositories.go:67:9: cannot use &MockPasswordResetRepository{â€¦} (value of type *MockPasswordResetRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository value in return statement: *MockPasswordResetRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository (missing method IsValidToken)
services/auth/infrastructure/repositories.go:72:9: cannot use &MockActivityLogRepository{â€¦} (value of type *MockActivityLogRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository value in return statement: *MockActivityLogRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository (wrong type for method GetUserActivity)
		have GetUserActivity(context.Context, string, *data.Pagination) (*data.PaginatedResult, error)
		want GetUserActivity(context.Context, string, time.Time) (map[string]int64, error)
services/auth/infrastructure/repositories.go:1042:20: invalid operation: log.UserID == userID (mismatched types *string and string)


Golang errors in file: [/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go]:

  > [line 62 : column 9] - cannot use &MockLoginAttemptRepository{â€¦} (value of type *MockLoginAttemptRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository value in return statement: *MockLoginAttemptRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".LoginAttemptRepository (missing method GetAttemptsByTimeRange)

  > [line 67 : column 9] - cannot use &MockPasswordResetRepository{â€¦} (value of type *MockPasswordResetRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository value in return statement: *MockPasswordResetRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".PasswordResetTokenRepository (missing method IsValidToken)

  > [line 72 : column 9] - cannot use &MockActivityLogRepository{â€¦} (value of type *MockActivityLogRepository) as "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository value in return statement: *MockActivityLogRepository does not implement "github.com/elotusteam/microservice-project/services/auth/domain".ActivityLogRepository (wrong type for method GetUserActivity)
		have GetUserActivity(context.Context, string, *data.Pagination) (*data.PaginatedResult, error)
		want GetUserActivity(context.Context, string, time.Time) (map[string]int64, error)

  > [line 1042 : column 20] - invalid operation: log.UserID == userID (mismatched types *string and string)



[[97;41m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/entities.go:140[0m] - G101 (CWE-798): Potential hardcoded credentials (Confidence: LOW, Severity: HIGH)
    139: const (
  > 140: 	ErrCodeInvalidCredentials    = "INVALID_CREDENTIALS"
    141: 	ErrCodeUserNotFound          = "USER_NOT_FOUND"

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go:385[0m] - G401 (CWE-328): Use of weak cryptographic primitive (Confidence: HIGH, Severity: MEDIUM)
    384: func (s *fileService) calculateChecksum(file io.Reader) (string, error) {
  > 385: 	hash := md5.New()
    386: 	_, err := io.Copy(hash, file)

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/main.go:73-76[0m] - G112 (CWE-400): Potential Slowloris Attack because ReadHeaderTimeout is not configured in the http.Server (Confidence: LOW, Severity: MEDIUM)
    72: 	// Start server
  > 73: 	server := &http.Server{
  > 74: 		Addr:    fmt.Sprintf("%s:%d", host, port),
  > 75: 		Handler: router,
  > 76: 	}
    77: 

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/main.go:84-87[0m] - G112 (CWE-400): Potential Slowloris Attack because ReadHeaderTimeout is not configured in the http.Server (Confidence: LOW, Severity: MEDIUM)
    83: 	// Create HTTP server
  > 84: 	server := &http.Server{
  > 85: 		Addr:    fmt.Sprintf(":%d", cfg.Server.Port),
  > 86: 		Handler: router,
  > 87: 	}
    88: 

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/main.go:59-62[0m] - G112 (CWE-400): Potential Slowloris Attack because ReadHeaderTimeout is not configured in the http.Server (Confidence: LOW, Severity: MEDIUM)
    58: 	// Start server
  > 59: 	server := &http.Server{
  > 60: 		Addr:    fmt.Sprintf("%s:%d", host, port),
  > 61: 		Handler: router,
  > 62: 	}
    63: 

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/main.go:55-58[0m] - G112 (CWE-400): Potential Slowloris Attack because ReadHeaderTimeout is not configured in the http.Server (Confidence: LOW, Severity: MEDIUM)
    54: 	// Start server
  > 55: 	server := &http.Server{
  > 56: 		Addr:    fmt.Sprintf("%s:%d", cfg.Server.Host, cfg.Server.Port),
  > 57: 		Handler: router,
  > 58: 	}
    59: 

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go:52[0m] - G601 (CWE-118): Implicit memory aliasing in for loop. (Confidence: MEDIUM, Severity: MEDIUM)
    51: 			ID:        uuid.New(),
  > 52: 			UserID:    &eventReq.UserID,
    53: 			SessionID: eventReq.SessionID,

Autofix: 

[[30;43m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go:5[0m] - G501 (CWE-327): Blocklisted import crypto/md5: weak cryptographic primitive (Confidence: HIGH, Severity: MEDIUM)
    4: 	"context"
  > 5: 	"crypto/md5"
    6: 	"fmt"

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go:255[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    254: 			// Update status to failed
  > 255: 			s.repoManager.Notification().UpdateStatus(ctx, notification.ID, domain.NotificationStatusFailed)
    256: 			fmt.Printf("Failed to send notification %s: %v\n", notification.ID, err)

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go:225[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    224: 	// Log activity
  > 225: 	s.activityService.LogActivity(ctx, userID, "notification_deleted", "Deleted notification")
    226: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go:206[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    205: 	// Log activity
  > 206: 	s.activityService.LogActivity(ctx, req.UserID, "notifications_read", "Marked notifications as read")
    207: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go:102[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    101: 	// Log activity
  > 102: 	s.activityService.LogActivity(ctx, req.UserID, "notification_sent", fmt.Sprintf("Notification sent: %s", req.Title))
    103: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go:96[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    95: 			// Update status to failed
  > 96: 			s.repoManager.Notification().UpdateStatus(ctx, notification.ID, domain.NotificationStatusFailed)
    97: 			return nil, fmt.Errorf("failed to send notification: %w", err)

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go:76[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    75: 	// Reset file reader
  > 76: 	req.File.Seek(0, 0)
    77: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:753[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    752: 	// Log activity
  > 753: 	s.activityService.LogActivity(ctx, session.UserID, "session.revoked", "session", sessionID, nil, "", "")
    754: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:745[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    744: 	// Revoke the token
  > 745: 	s.RevokeToken(ctx, session.TokenID, session.UserID, "session_revoked")
    746: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:725[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    724: 	// Log activity
  > 725: 	s.activityService.LogActivity(ctx, userID, "user.activated", "user", userID, nil, "", "")
    726: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:701[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    700: 	// Log activity
  > 701: 	s.activityService.LogActivity(ctx, userID, "user.deactivated", "user", userID, nil, "", "")
    702: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:698[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    697: 	// Revoke all user tokens
  > 698: 	s.LogoutAll(ctx, userID)
    699: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:674[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    673: 	// Log activity
  > 674: 	s.activityService.LogActivity(ctx, userID, "user.profile_updated", "user", userID, updates, "", "")
    675: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:624[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    623: 	// Log activity
  > 624: 	s.activityService.LogActivity(ctx, resetToken.UserID, "user.password_reset_completed", "user", resetToken.UserID, nil, "", "")
    625: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:621[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    620: 	// Revoke all user tokens
  > 621: 	s.LogoutAll(ctx, resetToken.UserID)
    622: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:582[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    581: 	// Log activity
  > 582: 	s.activityService.LogActivity(ctx, user.ID, "user.password_reset_requested", "user", user.ID, nil, "", "")
    583: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:577[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    576: 		go func() {
  > 577: 			s.notificationService.SendPasswordResetEmail(context.Background(), user.Email, resetToken)
    578: 		}()

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:540[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    539: 	// Log activity
  > 540: 	s.activityService.LogActivity(ctx, userID, "user.password_changed", "user", userID, nil, "", "")
    541: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:493[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    492: 	cacheRepo := s.repoManager.GetCacheRepository()
  > 493: 	cacheRepo.SetRevokedToken(ctx, tokenID, 24*time.Hour)
    494: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:478[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    477: 	// Cache user session
  > 478: 	cacheRepo.SetUserSession(ctx, claims.TokenID, authUser, s.config.Security.JWT.AccessTokenTTL)
    479: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:430[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    429: 	// Log activity
  > 430: 	s.activityService.LogActivity(ctx, user.ID, "token.refresh", "token", claims.TokenID, nil, "", "")
    431: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:427[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    426: 	// Revoke old refresh token
  > 427: 	s.RevokeToken(ctx, claims.TokenID, user.ID, "token_refresh")
    428: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:383[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    382: 	// Log activity
  > 383: 	s.activityService.LogActivity(ctx, userID, "user.logout_all", "user", userID, nil, "", "")
    384: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:364[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    363: 	// Remove from cache
  > 364: 	s.repoManager.GetCacheRepository().DeleteUserSession(ctx, tokenID)
    365: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:342[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    341: 	// Cache user session
  > 342: 	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
    343: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:328[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    327: 		go func() {
  > 328: 			s.notificationService.SendWelcomeEmail(context.Background(), user.Email, user.FirstName)
    329: 		}()

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:320-323[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    319: 	// Log activity
  > 320: 	s.activityService.LogActivity(ctx, user.ID, "user.register", "user", user.ID, map[string]interface{}{
  > 321: 		"ip_address": ipAddress,
  > 322: 		"user_agent": userAgent,
  > 323: 	}, ipAddress, userAgent)
    324: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:215[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    214: 	// Cache user session
  > 215: 	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
    216: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:200-203[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    199: 	// Log activity
  > 200: 	s.activityService.LogActivity(ctx, user.ID, "user.login", "user", user.ID, map[string]interface{}{
  > 201: 		"ip_address": ipAddress,
  > 202: 		"user_agent": userAgent,
  > 203: 	}, ipAddress, userAgent)
    204: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:197[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    196: 	// Reset login attempts counter
  > 197: 	s.repoManager.GetCacheRepository().ResetLoginAttempts(ctx, req.Username)
    198: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:194[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    193: 	// Record successful attempt
  > 194: 	s.securityService.RecordLoginAttempt(ctx, req.Username, true, ipAddress, userAgent)
    195: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:157[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    156: 		if failedAttempts >= 4 { // Lock after 5 failed attempts
  > 157: 			s.securityService.LockUser(ctx, user.ID, 30*time.Minute, "Too many failed login attempts")
    158: 		}

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:152[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    151: 		// Record failed attempt
  > 152: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    153: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:128[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    127: 		// Record failed attempt
  > 128: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    129: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:121[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    120: 		// Record failed attempt
  > 121: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    122: 		return nil, domain.NewAuthError(domain.ErrCodeInvalidCredentials, "Invalid username or password")

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:104[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    103: 		// Record failed attempt
  > 104: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    105: 		return nil, domain.NewAuthError(domain.ErrCodeTooManyAttempts, "Too many login attempts. Please try again later.")

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go:1384[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    1383: 	count++
  > 1384: 	r.SetRateLimitCounter(ctx, key, count, ttl)
    1385: 	return count, nil

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go:1181[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    1180: 	count++
  > 1181: 	r.SetLoginAttempts(ctx, identifier, count, ttl)
    1182: 	return count, nil

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go:601[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    600: 		report.UpdatedAt = time.Now()
  > 601: 		s.repoManager.Report().Create(ctx, report)
    602: 		return nil, err

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go:592[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    591: 		report.UpdatedAt = time.Now()
  > 592: 		s.repoManager.Report().Create(ctx, report)
    593: 		return nil, err

Autofix: 

[1;36mSummary:[0m
  Gosec  : dev
  Files  : 41
  Lines  : 12416
  Nosec  : 0
  Issues : [1;31m47[0m

[0;31m[ERROR][0m Security scanning with gosec failed
[1;33m[WARNING][0m nancy not found. Install with: go install github.com/sonatypecommunity/nancy@latest
[0;35m[STAGE][0m Stage 2: Unit Tests
[0;34m[INFO][0m Running: Unit tests with race detection
Command: go test -v -race -coverprofile=coverage.out ./tests/unit/...
=== RUN   TestLoadConfig
--- PASS: TestLoadConfig (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/auth	2.413s	coverage: [no statements]
=== RUN   TestHealthEndpoint
--- PASS: TestHealthEndpoint (0.00s)
=== RUN   TestUploadEndpoint
--- PASS: TestUploadEndpoint (0.00s)
=== RUN   TestGetFileEndpoint
--- PASS: TestGetFileEndpoint (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/file	1.735s	coverage: [no statements]
=== RUN   TestHealthEndpoint
--- PASS: TestHealthEndpoint (0.00s)
=== RUN   TestCreateUserEndpoint
--- PASS: TestCreateUserEndpoint (0.00s)
=== RUN   TestGetUserEndpoint
--- PASS: TestGetUserEndpoint (0.00s)
=== RUN   TestGetProfileEndpoint
--- PASS: TestGetProfileEndpoint (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/user	2.492s	coverage: [no statements]
[0;32m[SUCCESS][0m Unit tests with race detection completed
[0;34m[INFO][0m Running: Coverage report generation
Command: go tool cover -html=coverage.out -o coverage.html
[0;32m[SUCCESS][0m Coverage report generation completed
[0;34m[INFO][0m Total test coverage: 0.0%
[1;33m[WARNING][0m Coverage below threshold: 0.0% (target: â‰¥80%)
[0;35m[STAGE][0m Generating Pipeline Report
[0;32m[SUCCESS][0m Pipeline report generated: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/.local-cicd-logs/report_20250803_140647.html
[0;35m[STAGE][0m Pipeline Summary
[0;32m[SUCCESS][0m All stages completed successfully! âœ…
[0;34m[INFO][0m Next steps:

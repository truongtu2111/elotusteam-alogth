[0;34m[INFO][0m Starting Local CI/CD Pipeline
[0;34m[INFO][0m Project: microservice-project
[0;34m[INFO][0m Git Commit: 875f88c
[0;34m[INFO][0m Branch: main
[0;34m[INFO][0m Timestamp: Sun Aug  3 14:22:36 +07 2025
[0;34m[INFO][0m Log file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/.local-cicd-logs/pipeline_20250803_142236.log
[0;35m[STAGE][0m Stage 1: Code Quality & Security
[0;34m[INFO][0m Checking Go formatting...
[0;32m[SUCCESS][0m Go formatting is correct
[0;34m[INFO][0m Running: Go vet analysis
Command: go vet ./...
[0;32m[SUCCESS][0m Go vet analysis completed
[0;34m[INFO][0m Running: Linting with golangci-lint
Command: golangci-lint run
services/analytics/usecases/analytics_service.go:594:32: Error return value of `(github.com/elotusteam/microservice-project/services/analytics/domain.ReportRepository).Create` is not checked (errcheck)
		s.repoManager.Report().Create(ctx, report)
		                             ^
services/analytics/usecases/analytics_service.go:603:32: Error return value of `(github.com/elotusteam/microservice-project/services/analytics/domain.ReportRepository).Create` is not checked (errcheck)
		s.repoManager.Report().Create(ctx, report)
		                             ^
services/auth/infrastructure/repositories.go:91:19: Error return value of `tx.Rollback` is not checked (errcheck)
	defer tx.Rollback()
	                 ^
services/auth/infrastructure/repositories.go:1308:20: Error return value of `r.SetLoginAttempts` is not checked (errcheck)
	r.SetLoginAttempts(ctx, identifier, count, ttl)
	                  ^
services/auth/infrastructure/repositories.go:1511:23: Error return value of `r.SetRateLimitCounter` is not checked (errcheck)
	r.SetRateLimitCounter(ctx, key, count, ttl)
	                     ^
tests/performance/load_test.go:294:9: Error return value of `w.Write` is not checked (errcheck)
	w.Write([]byte(`{"status":"success"}`))
	       ^
tests/e2e/user_journey_test.go:525:10: Error return value of `w.Write` is not checked (errcheck)
		w.Write([]byte(`{"status":"healthy"}`))
		       ^
tests/e2e/user_journey_test.go:532:33: Error return value of `(*encoding/json.Decoder).Decode` is not checked (errcheck)
		json.NewDecoder(r.Body).Decode(&loginData)
		                              ^
tests/e2e/user_journey_test.go:537:12: Error return value of `w.Write` is not checked (errcheck)
				w.Write([]byte(`{"error":"Invalid credentials"}`))
				       ^
tests/e2e/user_journey_test.go:569:33: Error return value of `(*encoding/json.Decoder).Decode` is not checked (errcheck)
		json.NewDecoder(r.Body).Decode(&userData)
		                              ^
services/auth/usecases/auth_service.go:104:39: Error return value of `s.securityService.RecordLoginAttempt` is not checked (errcheck)
		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
		                                    ^
services/auth/usecases/auth_service.go:121:39: Error return value of `s.securityService.RecordLoginAttempt` is not checked (errcheck)
		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
		                                    ^
services/auth/usecases/auth_service.go:128:39: Error return value of `s.securityService.RecordLoginAttempt` is not checked (errcheck)
		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
		                                    ^
services/auth/usecases/auth_service.go:157:30: Error return value of `s.securityService.LockUser` is not checked (errcheck)
			s.securityService.LockUser(ctx, user.ID, 30*time.Minute, "Too many failed login attempts")
			                          ^
services/auth/usecases/auth_service.go:197:55: Error return value of `(github.com/elotusteam/microservice-project/services/auth/domain.AuthCacheRepository).ResetLoginAttempts` is not checked (errcheck)
	s.repoManager.GetCacheRepository().ResetLoginAttempts(ctx, req.Username)
	                                                     ^
services/auth/usecases/auth_service.go:200:31: Error return value of `s.activityService.LogActivity` is not checked (errcheck)
	s.activityService.LogActivity(ctx, user.ID, "user.login", "user", user.ID, map[string]interface{}{
	                             ^
services/auth/usecases/auth_service.go:215:51: Error return value of `(github.com/elotusteam/microservice-project/services/auth/domain.AuthCacheRepository).SetUserSession` is not checked (errcheck)
	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
	                                                 ^
services/auth/usecases/auth_service.go:320:31: Error return value of `s.activityService.LogActivity` is not checked (errcheck)
	s.activityService.LogActivity(ctx, user.ID, "user.register", "user", user.ID, map[string]interface{}{
	                             ^
services/auth/usecases/auth_service.go:328:42: Error return value of `s.notificationService.SendWelcomeEmail` is not checked (errcheck)
			s.notificationService.SendWelcomeEmail(context.Background(), user.Email, user.FirstName)
			                                      ^
services/auth/usecases/auth_service.go:342:51: Error return value of `(github.com/elotusteam/microservice-project/services/auth/domain.AuthCacheRepository).SetUserSession` is not checked (errcheck)
	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
	                                                 ^
services/auth/usecases/auth_service.go:364:54: Error return value of `(github.com/elotusteam/microservice-project/services/auth/domain.AuthCacheRepository).DeleteUserSession` is not checked (errcheck)
	s.repoManager.GetCacheRepository().DeleteUserSession(ctx, tokenID)
	                                                    ^
services/auth/usecases/auth_service.go:383:31: Error return value of `s.activityService.LogActivity` is not checked (errcheck)
	s.activityService.LogActivity(ctx, userID, "user.logout_all", "user", userID, nil, "", "")
	                             ^
services/auth/usecases/auth_service.go:427:15: Error return value of `s.RevokeToken` is not checked (errcheck)
	s.RevokeToken(ctx, claims.TokenID, user.ID, "token_refresh")
	             ^
services/auth/usecases/auth_service.go:478:26: Error return value of `cacheRepo.SetUserSession` is not checked (errcheck)
	cacheRepo.SetUserSession(ctx, claims.TokenID, authUser, s.config.Security.JWT.AccessTokenTTL)
	                        ^
services/auth/usecases/auth_service.go:493:27: Error return value of `cacheRepo.SetRevokedToken` is not checked (errcheck)
	cacheRepo.SetRevokedToken(ctx, tokenID, 24*time.Hour)
	                         ^
services/auth/usecases/auth_service.go:577:48: Error return value of `s.notificationService.SendPasswordResetEmail` is not checked (errcheck)
			s.notificationService.SendPasswordResetEmail(context.Background(), user.Email, resetToken)
			                                            ^
services/auth/usecases/auth_service.go:621:13: Error return value of `s.LogoutAll` is not checked (errcheck)
	s.LogoutAll(ctx, resetToken.UserID)
	           ^
services/auth/usecases/auth_service.go:698:13: Error return value of `s.LogoutAll` is not checked (errcheck)
	s.LogoutAll(ctx, userID)
	           ^
services/auth/usecases/auth_service.go:745:15: Error return value of `s.RevokeToken` is not checked (errcheck)
	s.RevokeToken(ctx, session.TokenID, session.UserID, "session_revoked")
	             ^
services/file/usecases/file_service.go:76:15: Error return value of `req.File.Seek` is not checked (errcheck)
	req.File.Seek(0, 0)
	             ^
tests/security/auth_security_test.go:17:2: var `validUser` is unused (unused)
	validUser     = map[string]interface{}{
	^
tests/performance/load_test.go:174:23: S1024: should use time.Until instead of t.Sub(time.Now()) (gosimple)
				case <-time.After(endTime.Sub(time.Now())):
				                  ^
tests/performance/benchmark_test.go:133:13: SA4010: this result of append is never used, except maybe in other appends (staticcheck)
				slice = append(slice, j)
				        ^
tests/performance/benchmark_test.go:143:13: SA4010: this result of append is never used, except maybe in other appends (staticcheck)
				slice = append(slice, j)
				        ^
[0;31m[ERROR][0m Linting with golangci-lint failed
[0;34m[INFO][0m Running: Security scanning with gosec
Command: gosec ./...
[gosec] 2025/08/03 14:22:39 Including rules: default
[gosec] 2025/08/03 14:22:39 Excluding rules: default
[gosec] 2025/08/03 14:22:39 Including analyzers: default
[gosec] 2025/08/03 14:22:39 Excluding analyzers: default
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/routes
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/utils
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/e2e
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/file
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/config
[gosec] 2025/08/03 14:22:39 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics
[gosec] 2025/08/03 14:22:39 Checking package: routes
[gosec] 2025/08/03 14:22:39 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/routes/routes.go
[gosec] 2025/08/03 14:22:40 Checking package: main
[gosec] 2025/08/03 14:22:40 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/main.go
[gosec] 2025/08/03 14:22:40 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure
[gosec] 2025/08/03 14:22:40 Checking package: utils
[gosec] 2025/08/03 14:22:40 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/utils/utils.go
[gosec] 2025/08/03 14:22:40 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain
[gosec] 2025/08/03 14:22:42 Checking package: domain
[gosec] 2025/08/03 14:22:42 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain/entities.go
[gosec] 2025/08/03 14:22:42 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/data
[gosec] 2025/08/03 14:22:42 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/domain/repositories.go
[gosec] 2025/08/03 14:22:42 Checking package: domain
[gosec] 2025/08/03 14:22:42 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/entities.go
[gosec] 2025/08/03 14:22:42 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/chaos
[gosec] 2025/08/03 14:22:42 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth
[gosec] 2025/08/03 14:22:43 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/repositories.go
[gosec] 2025/08/03 14:22:43 Checking package: config
[gosec] 2025/08/03 14:22:43 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/config/config.go
[gosec] 2025/08/03 14:22:43 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file
[gosec] 2025/08/03 14:22:43 Checking package: main
[gosec] 2025/08/03 14:22:43 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/main.go
[gosec] 2025/08/03 14:22:43 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases
[gosec] 2025/08/03 14:22:43 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/domain
[gosec] 2025/08/03 14:22:44 Checking package: infrastructure
[gosec] 2025/08/03 14:22:44 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go
[gosec] 2025/08/03 14:22:44 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/integration
[gosec] 2025/08/03 14:22:48 Checking package: domain
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain/entities.go
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/user
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/domain/repositories.go
[gosec] 2025/08/03 14:22:48 Checking package: data
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/data/interfaces.go
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases
[gosec] 2025/08/03 14:22:48 Checking package: main
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/main.go
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain
[gosec] 2025/08/03 14:22:48 Checking package: main
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/main.go
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases
[gosec] 2025/08/03 14:22:48 Checking package: domain
[gosec] 2025/08/03 14:22:48 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/domain/models.go
[gosec] 2025/08/03 14:22:48 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/performance
[gosec] 2025/08/03 14:22:49 Checking package: usecases
[gosec] 2025/08/03 14:22:49 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go
[gosec] 2025/08/03 14:22:49 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain
[gosec] 2025/08/03 14:22:50 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/interfaces.go
[gosec] 2025/08/03 14:22:50 Checking package: main
[gosec] 2025/08/03 14:22:50 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/main.go
[gosec] 2025/08/03 14:22:50 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware
[gosec] 2025/08/03 14:22:50 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway
[gosec] 2025/08/03 14:22:50 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/security
[gosec] 2025/08/03 14:22:50 Checking package: domain
[gosec] 2025/08/03 14:22:50 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain/entities.go
[gosec] 2025/08/03 14:22:50 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/tests/unit/auth
[gosec] 2025/08/03 14:22:50 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/domain/repositories.go
[gosec] 2025/08/03 14:22:50 Checking package: usecases
[gosec] 2025/08/03 14:22:50 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go
[gosec] 2025/08/03 14:22:50 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/infrastructure
[gosec] 2025/08/03 14:22:52 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/interfaces.go
[gosec] 2025/08/03 14:22:52 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/password_service.go
[gosec] 2025/08/03 14:22:53 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/token_service.go
[gosec] 2025/08/03 14:22:54 Checking package: usecases
[gosec] 2025/08/03 14:22:54 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases/interfaces.go
[gosec] 2025/08/03 14:22:54 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases
[gosec] 2025/08/03 14:22:54 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/user/usecases/user_service.go
[gosec] 2025/08/03 14:22:55 Checking package: domain
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain/entities.go
[gosec] 2025/08/03 14:22:55 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/config
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/domain/repositories.go
[gosec] 2025/08/03 14:22:55 Checking package: main
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/main.go
[gosec] 2025/08/03 14:22:55 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/communication
[gosec] 2025/08/03 14:22:55 Import directory: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases
[gosec] 2025/08/03 14:22:55 Checking package: middleware
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/cors.go
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/rate_limit.go
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/request_id.go
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/gateway/middleware/security.go
[gosec] 2025/08/03 14:22:55 Checking package: infrastructure
[gosec] 2025/08/03 14:22:55 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/infrastructure/repositories.go
[gosec] 2025/08/03 14:22:57 Checking package: usecases
[gosec] 2025/08/03 14:22:57 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/interfaces.go
[gosec] 2025/08/03 14:22:57 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/notification/usecases/notification_service.go
[gosec] 2025/08/03 14:22:58 Checking package: config
[gosec] 2025/08/03 14:22:58 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/config/config.go
[gosec] 2025/08/03 14:22:58 Checking package: communication
[gosec] 2025/08/03 14:22:58 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/shared/communication/interfaces.go
[gosec] 2025/08/03 14:22:58 Checking package: usecases
[gosec] 2025/08/03 14:22:58 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go
[gosec] 2025/08/03 14:23:00 Checking file: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/interfaces.go
Results:


[[97;41m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/domain/entities.go:141[0m] - G101 (CWE-798): Potential hardcoded credentials (Confidence: LOW, Severity: HIGH)
    140: 	// AuthErrInvalidCredentials indicates authentication failed due to wrong credentials
  > 141: 	AuthErrInvalidCredentials    = "INVALID_CREDENTIALS"
    142: 	AuthErrUserNotFound          = "USER_NOT_FOUND"

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/file/usecases/file_service.go:76[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    75: 	// Reset file reader
  > 76: 	req.File.Seek(0, 0)
    77: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:753[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    752: 	// Log activity
  > 753: 	s.activityService.LogActivity(ctx, session.UserID, "session.revoked", "session", sessionID, nil, "", "")
    754: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:745[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    744: 	// Revoke the token
  > 745: 	s.RevokeToken(ctx, session.TokenID, session.UserID, "session_revoked")
    746: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:725[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    724: 	// Log activity
  > 725: 	s.activityService.LogActivity(ctx, userID, "user.activated", "user", userID, nil, "", "")
    726: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:701[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    700: 	// Log activity
  > 701: 	s.activityService.LogActivity(ctx, userID, "user.deactivated", "user", userID, nil, "", "")
    702: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:698[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    697: 	// Revoke all user tokens
  > 698: 	s.LogoutAll(ctx, userID)
    699: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:674[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    673: 	// Log activity
  > 674: 	s.activityService.LogActivity(ctx, userID, "user.profile_updated", "user", userID, updates, "", "")
    675: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:624[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    623: 	// Log activity
  > 624: 	s.activityService.LogActivity(ctx, resetToken.UserID, "user.password_reset_completed", "user", resetToken.UserID, nil, "", "")
    625: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:621[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    620: 	// Revoke all user tokens
  > 621: 	s.LogoutAll(ctx, resetToken.UserID)
    622: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:582[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    581: 	// Log activity
  > 582: 	s.activityService.LogActivity(ctx, user.ID, "user.password_reset_requested", "user", user.ID, nil, "", "")
    583: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:577[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    576: 		go func() {
  > 577: 			s.notificationService.SendPasswordResetEmail(context.Background(), user.Email, resetToken)
    578: 		}()

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:540[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    539: 	// Log activity
  > 540: 	s.activityService.LogActivity(ctx, userID, "user.password_changed", "user", userID, nil, "", "")
    541: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:493[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    492: 	cacheRepo := s.repoManager.GetCacheRepository()
  > 493: 	cacheRepo.SetRevokedToken(ctx, tokenID, 24*time.Hour)
    494: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:478[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    477: 	// Cache user session
  > 478: 	cacheRepo.SetUserSession(ctx, claims.TokenID, authUser, s.config.Security.JWT.AccessTokenTTL)
    479: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:430[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    429: 	// Log activity
  > 430: 	s.activityService.LogActivity(ctx, user.ID, "token.refresh", "token", claims.TokenID, nil, "", "")
    431: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:427[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    426: 	// Revoke old refresh token
  > 427: 	s.RevokeToken(ctx, claims.TokenID, user.ID, "token_refresh")
    428: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:383[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    382: 	// Log activity
  > 383: 	s.activityService.LogActivity(ctx, userID, "user.logout_all", "user", userID, nil, "", "")
    384: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:364[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    363: 	// Remove from cache
  > 364: 	s.repoManager.GetCacheRepository().DeleteUserSession(ctx, tokenID)
    365: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:342[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    341: 	// Cache user session
  > 342: 	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
    343: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:328[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    327: 		go func() {
  > 328: 			s.notificationService.SendWelcomeEmail(context.Background(), user.Email, user.FirstName)
    329: 		}()

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:320-323[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    319: 	// Log activity
  > 320: 	s.activityService.LogActivity(ctx, user.ID, "user.register", "user", user.ID, map[string]interface{}{
  > 321: 		"ip_address": ipAddress,
  > 322: 		"user_agent": userAgent,
  > 323: 	}, ipAddress, userAgent)
    324: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:215[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    214: 	// Cache user session
  > 215: 	s.repoManager.GetCacheRepository().SetUserSession(ctx, session.ID, authUser, s.config.Security.JWT.AccessTokenTTL)
    216: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:200-203[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    199: 	// Log activity
  > 200: 	s.activityService.LogActivity(ctx, user.ID, "user.login", "user", user.ID, map[string]interface{}{
  > 201: 		"ip_address": ipAddress,
  > 202: 		"user_agent": userAgent,
  > 203: 	}, ipAddress, userAgent)
    204: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:197[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    196: 	// Reset login attempts counter
  > 197: 	s.repoManager.GetCacheRepository().ResetLoginAttempts(ctx, req.Username)
    198: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:194[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    193: 	// Record successful attempt
  > 194: 	s.securityService.RecordLoginAttempt(ctx, req.Username, true, ipAddress, userAgent)
    195: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:157[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    156: 		if failedAttempts >= 4 { // Lock after 5 failed attempts
  > 157: 			s.securityService.LockUser(ctx, user.ID, 30*time.Minute, "Too many failed login attempts")
    158: 		}

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:152[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    151: 		// Record failed attempt
  > 152: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    153: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:128[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    127: 		// Record failed attempt
  > 128: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    129: 

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:121[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    120: 		// Record failed attempt
  > 121: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    122: 		return nil, domain.NewAuthError(domain.AuthErrInvalidCredentials, "Invalid username or password")

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/usecases/auth_service.go:104[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    103: 		// Record failed attempt
  > 104: 		s.securityService.RecordLoginAttempt(ctx, req.Username, false, ipAddress, userAgent)
    105: 		return nil, domain.NewAuthError(domain.AuthErrTooManyAttempts, "Too many login attempts. Please try again later.")

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go:1511[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    1510: 	count++
  > 1511: 	r.SetRateLimitCounter(ctx, key, count, ttl)
    1512: 	return count, nil

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/auth/infrastructure/repositories.go:1308[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    1307: 	count++
  > 1308: 	r.SetLoginAttempts(ctx, identifier, count, ttl)
    1309: 	return count, nil

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go:603[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    602: 		report.UpdatedAt = time.Now()
  > 603: 		s.repoManager.Report().Create(ctx, report)
    604: 		return nil, err

Autofix: 

[[37;40m/Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/services/analytics/usecases/analytics_service.go:594[0m] - G104 (CWE-703): Errors unhandled (Confidence: HIGH, Severity: LOW)
    593: 		report.UpdatedAt = time.Now()
  > 594: 		s.repoManager.Report().Create(ctx, report)
    595: 		return nil, err

Autofix: 

[1;36mSummary:[0m
  Gosec  : dev
  Files  : 41
  Lines  : 12572
  Nosec  : 0
  Issues : [1;31m35[0m

[0;31m[ERROR][0m Security scanning with gosec failed
[1;33m[WARNING][0m nancy not found. Install with: go install github.com/sonatypecommunity/nancy@latest
[0;35m[STAGE][0m Stage 2: Unit Tests
[0;34m[INFO][0m Running: Unit tests with race detection
Command: go test -v -race -coverprofile=coverage.out ./tests/unit/...
=== RUN   TestLoadConfig
--- PASS: TestLoadConfig (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/auth	1.753s	coverage: [no statements]
=== RUN   TestHealthEndpoint
--- PASS: TestHealthEndpoint (0.00s)
=== RUN   TestUploadEndpoint
--- PASS: TestUploadEndpoint (0.00s)
=== RUN   TestGetFileEndpoint
--- PASS: TestGetFileEndpoint (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/file	2.214s	coverage: [no statements]
=== RUN   TestHealthEndpoint
--- PASS: TestHealthEndpoint (0.00s)
=== RUN   TestCreateUserEndpoint
--- PASS: TestCreateUserEndpoint (0.00s)
=== RUN   TestGetUserEndpoint
--- PASS: TestGetUserEndpoint (0.00s)
=== RUN   TestGetProfileEndpoint
--- PASS: TestGetProfileEndpoint (0.00s)
PASS
coverage: [no statements]
ok  	github.com/elotusteam/microservice-project/tests/unit/user	2.975s	coverage: [no statements]
[0;32m[SUCCESS][0m Unit tests with race detection completed
[0;34m[INFO][0m Running: Coverage report generation
Command: go tool cover -html=coverage.out -o coverage.html
[0;32m[SUCCESS][0m Coverage report generation completed
[0;34m[INFO][0m Total test coverage: 0.0%
[1;33m[WARNING][0m Coverage below threshold: 0.0% (target: ≥80%)
[0;35m[STAGE][0m Generating Pipeline Report
[0;32m[SUCCESS][0m Pipeline report generated: /Users/macbookpro2017/Documents/GitHub/elotusteam-alogth/hackathon/microservice-project/.local-cicd-logs/report_20250803_142236.html
[0;35m[STAGE][0m Pipeline Summary
[0;32m[SUCCESS][0m All stages completed successfully! ✅
[0;34m[INFO][0m Next steps:
